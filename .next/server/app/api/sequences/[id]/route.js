"use strict";(()=>{var e={};e.id=610,e.ids=[610],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},70:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>O,patchFetch:()=>g,requestAsyncStorage:()=>j,routeModule:()=>w,serverHooks:()=>E,staticGenerationAsyncStorage:()=>x});var r={};n.r(r),n.d(r,{DELETE:()=>h,GET:()=>_,PATCH:()=>y,POST:()=>R});var s=n(9303),a=n(8716),i=n(3131),o=n(2602),u=n(6543);let d=[],c=[{id:"step-1",sequence_id:"1",order:1,type:"email",delay_days:0,template_id:null,content:"Hi {{investor_first_name}}, I wanted to reach out about our Series A...",subject:"Quick intro - {{company_name}}"},{id:"step-2",sequence_id:"1",order:2,type:"wait",delay_days:3,template_id:null,content:null,subject:null},{id:"step-3",sequence_id:"1",order:3,type:"email",delay_days:0,template_id:null,content:"Hi {{investor_first_name}}, just following up on my previous email...",subject:"Re: Quick intro - {{company_name}}"}],l=u.Ryn({name:u.Z_8().min(1).max(100).optional(),status:u.KmV(["draft","active","paused"]).optional()}),p=u.Ryn({order:u.Rxh().int().positive(),type:u.KmV(["email","linkedin","task","wait"]),delay_days:u.Rxh().int().min(0).default(0),template_id:u.Z_8().uuid().optional(),content:u.Z_8().max(1e4).optional(),subject:u.Z_8().max(200).optional()});function m(e){let t=l.safeParse(e);if(!t.success){let e={};throw t.error.issues.forEach(t=>{let n=t.path.join(".")||"root";e[n]||(e[n]=[]),e[n].push(t.message)}),new o.p8("Validation failed",e)}return t.data}function f(e){let t=p.safeParse(e);if(!t.success){let e={};throw t.error.issues.forEach(t=>{let n=t.path.join(".")||"root";e[n]||(e[n]=[]),e[n].push(t.message)}),new o.p8("Validation failed",e)}return t.data}async function _(e,{params:t}){return(0,o.bi)(async()=>{let{id:e}=await t,n=d.find(t=>t.id===e);if(!n){let e={id:"1",campaign_id:"1",name:"Initial Outreach",status:"active",created_at:new Date().toISOString(),steps:c.filter(e=>"1"===e.sequence_id)};return(0,o.Xj)(e)}let r=c.filter(t=>t.sequence_id===e);return(0,o.Xj)({...n,steps:r})})}async function y(e,{params:t}){return(0,o.bi)(async()=>{let{id:n}=await t,r=await (0,o.Kz)(e,m),s=d.findIndex(e=>e.id===n);if(-1===s){let e={id:n,campaign_id:"1",name:r.name??"Updated Sequence",status:r.status??"draft",created_at:new Date().toISOString()};return d.push(e),(0,o.Xj)(e)}let a=d[s];if(!a)throw new o.dR("Sequence");let i={...a,...r};return d[s]=i,(0,o.Xj)(i)})}async function h(e,{params:t}){return(0,o.bi)(async()=>{let{id:e}=await t,n=d.findIndex(t=>t.id===e);return -1!==n&&d.splice(n,1),(0,o.Xj)({deleted:!0})})}async function R(e,{params:t}){return(0,o.bi)(async()=>{let{id:n}=await t,r=await (0,o.Kz)(e,f),s={id:`step-${Date.now()}`,sequence_id:n,order:r.order,type:r.type,delay_days:r.delay_days,template_id:r.template_id??null,content:r.content??null,subject:r.subject??null};return c.push(s),(0,o.Xj)(s)})}let w=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/sequences/[id]/route",pathname:"/api/sequences/[id]",filename:"route",bundlePath:"app/api/sequences/[id]/route"},resolvedPagePath:"/Users/jessewitkowski/Projects/cap-outro/src/app/api/sequences/[id]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:j,staticGenerationAsyncStorage:x,serverHooks:E}=w,O="/api/sequences/[id]/route";function g(){return(0,i.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:x})}},2602:(e,t,n)=>{n.d(t,{Kz:()=>c,Xj:()=>o,bi:()=>d,dR:()=>i,p8:()=>a});var r=n(7070);class s extends Error{constructor(e,t,n){super(t),this.code=e,this.details=n,this.name="AppError"}}class a extends s{constructor(e,t){super("VALIDATION_ERROR",e,t),this.name="ValidationError"}}class i extends s{constructor(e){super("NOT_FOUND",`${e} not found`),this.name="NotFoundError"}}function o(e,t){return r.NextResponse.json({success:!0,data:e,...t&&{meta:t}})}function u(e){if(e instanceof s){let t={UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,VALIDATION_ERROR:400,RATE_LIMITED:429,INTERNAL_ERROR:500}[e.code];return r.NextResponse.json({success:!1,error:{code:e.code,message:e.message,...e.details&&{details:e.details}}},{status:t})}return console.error("Unhandled error:",e),r.NextResponse.json({success:!1,error:{code:"INTERNAL_ERROR",message:"An unexpected error occurred"}},{status:500})}function d(e){return e().catch(e=>e instanceof s||e instanceof Error?u(e):u(Error("Unknown error")))}async function c(e,t){try{let n=await e.json();return t(n)}catch(e){if(e instanceof a)throw e;throw new a("Invalid JSON body")}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,972,543],()=>n(70));module.exports=r})();